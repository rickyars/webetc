<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ETC RPC Endpoint Tester</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Courier New', monospace;
      background: #0a0e27;
      color: #00ff41;
      padding: 20px;
      line-height: 1.6;
    }

    .container {
      max-width: 1000px;
      margin: 0 auto;
    }

    h1 {
      color: #00ff41;
      margin-bottom: 10px;
      font-size: 24px;
      text-shadow: 0 0 10px #00ff41;
    }

    .subtitle {
      color: #888;
      margin-bottom: 30px;
      font-size: 14px;
    }

    .section {
      background: #1a1f3a;
      border: 1px solid #00ff41;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 20px;
    }

    .section h2 {
      color: #00ff41;
      font-size: 18px;
      margin-bottom: 15px;
    }

    .form-group {
      margin-bottom: 15px;
    }

    label {
      display: block;
      color: #888;
      margin-bottom: 5px;
      font-size: 12px;
    }

    input, select {
      width: 100%;
      padding: 10px;
      background: #0a0e27;
      border: 1px solid #333;
      border-radius: 4px;
      color: #00ff41;
      font-family: 'Courier New', monospace;
      font-size: 14px;
    }

    input:focus, select:focus {
      outline: none;
      border-color: #00ff41;
    }

    button {
      padding: 12px 20px;
      background: #00ff41;
      color: #0a0e27;
      border: none;
      border-radius: 4px;
      font-family: 'Courier New', monospace;
      font-size: 14px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s;
      width: 100%;
    }

    button:hover {
      background: #00cc33;
      box-shadow: 0 0 20px #00ff41;
    }

    button:disabled {
      background: #333;
      color: #666;
      cursor: not-allowed;
      box-shadow: none;
    }

    .endpoint-list {
      margin-bottom: 15px;
    }

    .endpoint-item {
      background: #0a0e27;
      border: 1px solid #333;
      border-radius: 4px;
      padding: 10px;
      margin-bottom: 8px;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .endpoint-item:hover {
      border-color: #00ff41;
      background: #1a1f3a;
    }

    .endpoint-item .url {
      color: #00ff41;
      font-size: 13px;
    }

    .endpoint-item .status {
      font-size: 11px;
      color: #888;
    }

    .result-box {
      background: #0a0e27;
      border: 1px solid #333;
      border-radius: 4px;
      padding: 15px;
      margin-top: 15px;
      max-height: 400px;
      overflow-y: auto;
      font-size: 13px;
      white-space: pre-wrap;
      word-break: break-all;
    }

    .result-box.success {
      border-color: #00ff41;
      color: #00ff41;
    }

    .result-box.error {
      border-color: #ff4444;
      color: #ff4444;
    }

    .result-box.info {
      border-color: #888;
      color: #888;
    }

    .stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 10px;
      margin-bottom: 15px;
    }

    .stat-card {
      background: #0a0e27;
      border: 1px solid #333;
      border-radius: 4px;
      padding: 10px;
    }

    .stat-card .label {
      color: #888;
      font-size: 11px;
      margin-bottom: 5px;
    }

    .stat-card .value {
      color: #00ff41;
      font-size: 16px;
      font-weight: bold;
    }

    .loading {
      animation: pulse 1.5s infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üîå ETC RPC Endpoint Tester</h1>
    <p class="subtitle">Test eth_getWork on various ETC RPC endpoints (no actual mining)</p>

    <!-- Endpoint Selection -->
    <div class="section">
      <h2>üì° Select Endpoint</h2>
      <div class="endpoint-list" id="endpointList">
        <!-- Populated by JS -->
      </div>
      <div class="form-group">
        <label>Or enter custom endpoint:</label>
        <input type="text" id="customEndpoint" placeholder="https://your-rpc-endpoint.com">
      </div>
      <button id="testBtn">Test eth_getWork</button>
    </div>

    <!-- Results -->
    <div class="section">
      <h2>üìä Results</h2>
      <div class="stats">
        <div class="stat-card">
          <div class="label">Endpoint</div>
          <div class="value" id="currentEndpoint">-</div>
        </div>
        <div class="stat-card">
          <div class="label">Status</div>
          <div class="value" id="status">Ready</div>
        </div>
        <div class="stat-card">
          <div class="label">Block Number</div>
          <div class="value" id="blockNumber">-</div>
        </div>
      </div>
      <div id="resultBox" class="result-box info">
        Click "Test eth_getWork" to begin testing...
      </div>
    </div>

    <!-- Info -->
    <div class="section">
      <h2>‚ÑπÔ∏è What This Tests</h2>
      <p style="color: #888; font-size: 13px; line-height: 1.8;">
        This page tests if an ETC RPC endpoint supports the <code style="color: #00ff41;">eth_getWork</code> method.<br><br>
        <strong>Possible responses:</strong><br>
        ‚Ä¢ <span style="color: #00ff41;">‚úì Success</span>: Returns [headerHash, seedHash, target] - endpoint provides mining work!<br>
        ‚Ä¢ <span style="color: #ffaa00;">‚ö† No work available</span>: Method exists but no mining work (error -32000)<br>
        ‚Ä¢ <span style="color: #ff4444;">‚úó Method not found</span>: Endpoint doesn't support eth_getWork (error -32601)<br>
        ‚Ä¢ <span style="color: #ff4444;">‚úó Connection error</span>: Network/CORS issues
      </p>
    </div>
  </div>

  <script type="module">
    // Known ETC endpoints (October 2025 list from ChainList.org)
    // No guarantee these will continue to work in the future
    // ‚úÖ = Supports eth_getWork (though may not have active mining work)
    // ‚ùå = Does not support eth_getWork
    const knownEndpoints = [
      // Endpoints that SUPPORT eth_getWork (reordered to top)
      { url: 'https://etc.etcdesktop.com', note: '‚úÖ ETC Desktop (supports eth_getWork)' },
      { url: 'https://geth-at.etc-network.info', note: '‚úÖ ETC Network Geth (supports eth_getWork)' },

      // Other endpoints (may not support eth_getWork)
      { url: 'https://etc.mytokenpocket.vip', note: 'TokenPocket (ChainList)' },
      { url: 'https://rpc.etcinscribe.com', note: 'ETC Inscribe (ChainList)' },
      { url: 'https://besu-at.etc-network.info', note: 'ETC Network Besu (ChainList)' },
      { url: 'https://etc.rivet.link', note: 'Rivet Cloud (ChainList)' },
      { url: 'https://0xrpc.io/etc', note: '0xRPC (ChainList)' },
      { url: 'https://ethereum-classic-mainnet.gateway.tatum.io', note: 'Tatum (ChainList)' },
      { url: 'http://localhost:8545', note: 'Local Node' },
    ];

    let selectedEndpoint = knownEndpoints[0].url;

    // Render endpoint list
    function renderEndpoints() {
      const list = document.getElementById('endpointList');
      list.innerHTML = knownEndpoints.map(ep => `
        <div class="endpoint-item" onclick="selectEndpoint('${ep.url}')">
          <div>
            <div class="url">${ep.url}</div>
            <div class="status">${ep.note}</div>
          </div>
        </div>
      `).join('');
    }

    window.selectEndpoint = function(url) {
      selectedEndpoint = url;
      document.getElementById('customEndpoint').value = url;
      document.getElementById('currentEndpoint').textContent = url.replace('https://', '').replace('http://', '').substring(0, 30);
    };

    // Test endpoint
    async function testEndpoint() {
      const customUrl = document.getElementById('customEndpoint').value.trim();
      const testUrl = customUrl || selectedEndpoint;

      document.getElementById('currentEndpoint').textContent = testUrl.replace('https://', '').replace('http://', '').substring(0, 30);
      document.getElementById('status').textContent = 'Testing...';
      document.getElementById('status').classList.add('loading');
      document.getElementById('testBtn').disabled = true;

      const resultBox = document.getElementById('resultBox');
      resultBox.className = 'result-box info';
      resultBox.textContent = 'Connecting to ' + testUrl + '...\n\n';

      try {
        // First, test basic connectivity with eth_blockNumber
        resultBox.textContent += '1. Testing basic connectivity (eth_blockNumber)...\n';
        const blockResponse = await fetch(testUrl, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            jsonrpc: '2.0',
            method: 'eth_blockNumber',
            params: [],
            id: 1
          })
        });

        if (!blockResponse.ok) {
          throw new Error(`HTTP ${blockResponse.status}: ${blockResponse.statusText}`);
        }

        const blockData = await blockResponse.json();
        if (blockData.error) {
          throw new Error(`RPC Error: ${blockData.error.message}`);
        }

        const blockNumber = parseInt(blockData.result, 16);
        document.getElementById('blockNumber').textContent = blockNumber.toLocaleString();
        resultBox.textContent += `   ‚úì Connected! Block: ${blockNumber.toLocaleString()}\n\n`;

        // Now test eth_getWork
        resultBox.textContent += '2. Testing eth_getWork...\n';
        const workResponse = await fetch(testUrl, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            jsonrpc: '2.0',
            method: 'eth_getWork',
            params: [],
            id: 2
          })
        });

        const workData = await workResponse.json();

        if (workData.result) {
          // Success! Got mining work
          resultBox.className = 'result-box success';
          resultBox.textContent += '   ‚úì SUCCESS! Got mining work:\n\n';
          resultBox.textContent += JSON.stringify(workData, null, 2);
          resultBox.textContent += '\n\n';
          resultBox.textContent += `   HeaderHash: ${workData.result[0]}\n`;
          resultBox.textContent += `   SeedHash:   ${workData.result[1]}\n`;
          resultBox.textContent += `   Target:     ${workData.result[2]}\n`;
          document.getElementById('status').textContent = '‚úì Has Work!';
        } else if (workData.error) {
          // Got an error
          if (workData.error.code === -32601) {
            // Method not found
            resultBox.className = 'result-box error';
            resultBox.textContent += '   ‚úó Method not supported\n\n';
            resultBox.textContent += `   Error: ${workData.error.message}\n`;
            resultBox.textContent += '   This endpoint does NOT support eth_getWork.\n';
            document.getElementById('status').textContent = '‚úó No Support';
          } else if (workData.error.code === -32000) {
            // Method exists but no work
            resultBox.className = 'result-box info';
            resultBox.textContent += '   ‚ö† Method supported but no work available\n\n';
            resultBox.textContent += `   Error: ${workData.error.message}\n`;
            resultBox.textContent += '   This endpoint supports eth_getWork but isn\'t mining.\n';
            document.getElementById('status').textContent = '‚ö† No Work';
          } else {
            // Other error
            resultBox.className = 'result-box error';
            resultBox.textContent += '   ‚úó Error\n\n';
            resultBox.textContent += JSON.stringify(workData.error, null, 2);
            document.getElementById('status').textContent = '‚úó Error';
          }
        }

      } catch (error) {
        resultBox.className = 'result-box error';
        resultBox.textContent += '\n‚úó Connection failed:\n\n';
        resultBox.textContent += error.message;
        resultBox.textContent += '\n\nPossible issues:\n';
        resultBox.textContent += '‚Ä¢ CORS not enabled on endpoint\n';
        resultBox.textContent += '‚Ä¢ Network/firewall blocking request\n';
        resultBox.textContent += '‚Ä¢ Endpoint is down\n';
        document.getElementById('status').textContent = '‚úó Failed';
      } finally {
        document.getElementById('status').classList.remove('loading');
        document.getElementById('testBtn').disabled = false;
      }
    }

    // Initialize
    renderEndpoints();
    selectEndpoint(knownEndpoints[0].url);

    // Event listeners
    document.getElementById('testBtn').addEventListener('click', testEndpoint);
    document.getElementById('customEndpoint').addEventListener('input', (e) => {
      if (e.target.value.trim()) {
        selectedEndpoint = e.target.value.trim();
      }
    });
  </script>
</body>
</html>
